#!/usr/bin/env php
<?php

require __DIR__ . '/../vendor/autoload.php';

use Testify\Runner;

$configFile = __DIR__ . '/../phpunit.config.php';

$runner = new Runner($configFile);

try {
    $runner->run();
    exit(0);
} catch (Throwable $e) {
    // NOTE:
    // Our Printer already printed per-test failures.
    // This is just a final line + proper exit code for CI.
    $code = $e->getCode();
    if (!is_int($code) || $code === 0) {
        $code = 1;
    }

    fwrite(STDERR, "[php-testify] " . $e->getMessage() . PHP_EOL);
    exit($code);
}
